<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="partyns">

	<!-- 게시판 내용보기 -->
	<select id="party_cont" resultType="party"
		parameterType="int">
		select * from party where party_no = #{party_no}
	</select>

	<!-- 파티방 목록 -->
	<select id="party_list" parameterType="int" resultType="party">
	    	<![CDATA[
				select * from 
				(select rownum rnum, party.* from 
				 (select * from party order by party_no desc) party) 
			   	where rnum >= ((#{page} - 1) * 8 + 1)  and rnum <= (#{page} * 8)
			]]>
	</select>
	
	<!-- 파티방 저장-->
	<insert id="party_insert" parameterType="party">
		insert into party values(party_no_seq.nextval,#{party_subject},#{party_address},
		#{party_content},#{party_gender},#{party_age},sysdate,#{party_enddate},
		0, #{party_max_count},#{party_id})
	</insert>

	<!-- 파티방 총 개수 -->
	<select id="party_count" resultType="int">
		select count(*) from party
	</select>
	
	<!-- 파티방 참가 신청 -->
	<update id="party_join" parameterType="int">
		update party set party_count = party_count + 1 where party_no = #{party_no}
	</update>
	
	<!-- member에 가입된 비밀번호 확인 -->
	<select id="pw_checek" parameterType="String" resultType="String">
		select member_passwd from member where member_id = #{member_id}
	</select>
	
	<!-- 파티방 수정 -->
	<update id="party_edit" parameterType="party">
		update party set
		party_address=#{party_address},
		party_age=#{party_age},
		party_gender=#{party_gender},
		party_enddate=#{party_enddate},
		party_subject=#{party_subject},
		party_content=#{party_content}
		where party_no=#{party_no}
	</update>
	
	<!-- 파티방 삭제 -->
	<delete id="party_delete" parameterType="String">
		delete from party where party_no=#{party_no}
	</delete>
</mapper>
